<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <!-- If you build the project from the command prompt, use the TemplatesVSVersion environment variable. -->
        <TemplatesTargetVersion Condition=" '$(TemplatesTargetVersion)' == '' ">$(TemplatesVSVersion)</TemplatesTargetVersion>

        <!-- If you open VS directly from the Windows shell, use the VS version as the target version. -->
        <TemplatesTargetVersion Condition=" '$(TemplatesTargetVersion)' == '' ">$(VisualStudioVersion)</TemplatesTargetVersion>

        <!-- Usually these are environment variables, but they aren't set when running VS -->
        <TemplatesRoot Condition=" '$(TemplatesRoot)' == '' ">$(MSBuildThisFileDirectory)</TemplatesRoot>
        <TemplatesBin Condition=" '$(TemplatesBin)' == '' ">$(TemplatesRoot)artifacts\build</TemplatesBin>
        <TemplatesIntermediate Condition=" '$(TemplatesIntermediate)' == '' ">$(TemplatesRoot)intermediate</TemplatesIntermediate>
        <TemplatesReferences Condition=" '$(TemplatesReferences)' == '' ">$(TemplatesRoot)references</TemplatesReferences>
        <TemplatesReferencePackages Condition=" '$(TemplatesReferencePackages)' == '' ">$(TemplatesRoot)\references\packages</TemplatesReferencePackages>
        <TemplatesSource Condition=" '$(TemplatesSource)' == '' ">$(TemplatesRoot)src</TemplatesSource>
        <TemplatesTest Condition=" '$(TemplatesTest)' == '' ">$(TemplatesRoot)test</TemplatesTest>
        <TemplatesTools Condition=" '$(TemplatesTools)' == '' ">$(TemplatesRoot)tools</TemplatesTools>
        <TemplatesSetup Condition=" '$(TemplatesSetup)' == '' ">$(TemplatesRoot)setup</TemplatesSetup>
        <TemplatesTestResults Condition=" '$(TemplatesTestResults)' == '' ">$(TemplatesRoot)TestResults</TemplatesTestResults>
    </PropertyGroup>
    
    <PropertyGroup>
        <IsOfficialBuild Condition="'$(IsOfficialBuild)' == ''">false</IsOfficialBuild>
        <PackageVersionType Condition="'$(PackageVersionType)' == ''">$(BUILD_BRANCH)</PackageVersionType>
        <PackageVersion Condition="'$(PackageVersion)' == ''">$(CoherenceBuildNumber)</PackageVersion>
        <PackageVersion Condition="'$(PackageVersion)' == ''">Latest</PackageVersion>
        <TemplateVersion Condition="'$(TemplateVersion)' == ''">$(BUILD_NUMBER)</TemplateVersion>
        <TemplateVersion Condition="'$(TemplateVersion)' == ''">Local</TemplateVersion>
        <PackageType Condition="'$(PackageVersionType)' == 'release'">$(ReleasePackageType)</PackageType>
        <PackageType Condition="'$(PackageVersionType)' == 'dev'">$(DevPackageType)</PackageType>
        <CoherencePackageSource Condition="'$(CoherencePackageSource)' != ''">$(CoherencePackageSource)\$(PackageType)</CoherencePackageSource>
        <PackageSource Condition="'$(PackageSource)' != ''">$(PackageSource)\$(PackageType)</PackageSource>
        <PackageSource Condition="'$(PackageSource)' == '' and '$(PackageVersionType)' == 'dev'">https://www.myget.org/F/aspnetvnext/</PackageSource>
        <PackageSourceForRestore>$(PackageSource) -f $(TemplatesReferences)\Packages</PackageSourceForRestore>
        <ForceNpmInstall Condition="'$(ForceNpmInstall)' == ''">false</ForceNpmInstall>
    </PropertyGroup>

    <PropertyGroup>
        <TemplatePackages>$(MSBuildThisFileDirectory)\TemplatePackages.txt</TemplatePackages>
        <DependencyListFilename>PackageList.generated.txt</DependencyListFilename>
        <MergedDependencyListPath>$(TemplatesBin)\PackageList.generated.txt</MergedDependencyListPath>
        <CoherenceDropFile>$(TemplatesBin)\Packages.source.txt</CoherenceDropFile>
    </PropertyGroup>

    <PropertyGroup Condition=" '$(TemplatesTargetVersion)' == '14.0' ">
        <!-- Visual Studio 14 properties -->
        <TemplatesTargetVersionPath>\dev14</TemplatesTargetVersionPath>
        <VersionedReferencePath>Dev14</VersionedReferencePath>
        <TargetVsVersion>VS14</TargetVsVersion>
    </PropertyGroup>

    <PropertyGroup>
        <!-- Output -->
        <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
        <Platform Condition=" '$(Platform)' == '' ">AnyCPU</Platform>
        <OutputPath>$(TemplatesBin)</OutputPath>
        <IntermediateOutputPath>$(TemplatesIntermediate)</IntermediateOutputPath>
        <BaseIntermediateOutputPath>$(TemplatesIntermediate)</BaseIntermediateOutputPath>
    </PropertyGroup>
    
    <ItemGroup>
        <TestTemplates Include="$(TemplatesBin)\test\ClassLibrary"/>
        <TestTemplates Include="$(TemplatesBin)\test\StarterWeb"/>
        <TestTemplates Include="$(TemplatesBin)\test\StarterWeb.IndividualAuth"/>
        <TestTemplates Include="$(TemplatesBin)\test\ConsoleApp"/>
        <TestTemplates Include="$(TemplatesBin)\test\EmptyWeb"/>
        <TestTemplates Include="$(TemplatesBin)\test\WebAPI"/>
    </ItemGroup>

    <!-- These packages get copied to ExternalPackages on official builds -->
    <ItemGroup>
      <ExternalReferencePackage Include="Ix-Async">
          <Version>1.2.3</Version>
      </ExternalReferencePackage>
      <ExternalReferencePackage Include="Remotion.Linq">
          <Version>2.0.0-alpha-002</Version>
      </ExternalReferencePackage>
      <ExternalReferencePackage Include="System.Collections.Immutable">
          <Version>1.1.34-rc</Version>
      </ExternalReferencePackage>
      <ExternalReferencePackage Include="System.Reflection.Metadata">
          <Version>1.0.19-rc</Version>
      </ExternalReferencePackage>
      <ExternalReferencePackage Include="Newtonsoft.Json">
          <Version>6.0.6</Version>
      </ExternalReferencePackage>
    </ItemGroup>
</Project>
